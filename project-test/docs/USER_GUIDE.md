# ETF动量决策系统 - 用户使用指南

## 📚 目录

1. [系统概述](#系统概述)
2. [快速开始](#快速开始)
3. [核心功能使用](#核心功能使用)
4. [策略配置](#策略配置)
5. [日常操作流程](#日常操作流程)
6. [风险管理](#风险管理)
7. [常见问题](#常见问题)

## 系统概述

### 系统定位
本系统是一个**半自动化投资决策辅助工具**，帮助您：
- 基于动量策略选择ETF
- 管理核心-卫星资产配置
- 执行可转债网格交易
- 生成每周交易计划

### 核心理念
- **核心资产（40%）**：稳健配置，长期持有
- **卫星资产（30%）**：动量轮动，追求超额收益
- **可转债（10%）**：网格交易，增强收益
- **现金储备（20%）**：灵活调配，风险缓冲

## 快速开始

### 第一次使用

1. **启动系统**
```bash
./start.sh
# 选择 1 使用Docker模式（推荐）
```

2. **访问界面**
- 打开浏览器访问：http://localhost:3000
- 首次访问会看到初始化向导

3. **配置初始参数**
- 输入总资金额度
- 选择风险偏好（保守/均衡/进取）
- 设置建仓周期（默认6周）

4. **查看首次建议**
- 系统会自动生成第一周的投资建议
- 包括具体的买入标的和金额

## 核心功能使用

### 1. 决策控制台

**位置**：首页 / Dashboard

**功能**：
- 🚦 **市场环境灯**：显示当前市场状态
  - 🟢 绿灯：年线上方，趋势良好
  - 🟡 黄灯：震荡市，谨慎操作
  - 🔴 红灯：年线下方，防御模式

- 📊 **持仓概览**：当前资产配置饼图
- 📈 **今日建议**：本周交易建议列表
- ⚠️ **风险警告**：需要关注的风险点

### 2. 卫星模块

**位置**：菜单 > 卫星策略

**功能**：
- **动量排行榜**：查看ETF动量得分排名
- **持仓管理**：
  - 第一条腿：主要动量标的
  - 第二条腿：分散化标的
- **换腿建议**：何时更换持仓

**操作流程**：
1. 查看动量排行榜Top10
2. 检查相关性矩阵（避免>0.8）
3. 确认流动性指标（日均成交>5000万）
4. 生成买入订单

### 3. Core资产配置

**位置**：菜单 > Core配置

**标准配置**：
| 资产类型 | 代码示例 | 目标权重 | 说明 |
|---------|---------|---------|------|
| 宽基指数 | 510300 | 20% | 沪深300ETF |
| 红利策略 | 510880 | 10% | 红利ETF |
| 债券/货币 | 511990 | 15% | 华宝添益 |
| 黄金 | 518880 | 10% | 黄金ETF |
| 海外资产 | 513500 | 5% | 标普500 |

**再平衡规则**：
- 触发条件：偏离目标±5%
- 检查频率：每月月末
- 执行方式：渐进式调整

### 4. 可转债网格

**位置**：菜单 > 可转债

**选券标准**：
- 价格：100-130元
- 溢价率：<40%
- 评级：AA-以上
- 规模：>5亿

**网格设置**：
- 基准价：昨收盘价
- 网格宽度：2-5%（根据波动率自动调整）
- 每格数量：10张
- 网格层数：上下各5层

### 5. 订单导出

**位置**：决策台 > 导出订单

**导出格式**：
- CSV格式：适合Excel查看
- JSON格式：适合程序化交易
- PDF报告：适合存档记录

**订单内容**：
- ETF时间条件单（周二10:30/14:00）
- 可转债价格网格单
- IOPV限价区间（如可用）

## 策略配置

### 配置文件位置
```
config/
├── config.yaml      # 主配置
├── positions.yaml   # 持仓记录
└── build_plan.yaml  # 建仓计划
```

### 关键参数调整

**风险参数**（config.yaml）：
```yaml
satellite_rules:
  stop_loss: -0.12      # 止损线（可调整-10%到-15%）
  buffer_pct: 0.03      # 缓冲区（可调整2%-5%）
  min_hold_weeks: 2     # 最短持有期（可调整1-4周）
  corr_max: 0.8        # 相关性上限
```

**执行参数**：
```yaml
execution_day: "Tue"    # 执行日（周二）
execution_windows:      # 执行时间窗口
  - "10:30"            # 第一批
  - "14:00"            # 第二批
```

## 日常操作流程

### 周一：准备阶段
1. 登录系统查看本周建议
2. 检查风险警告
3. 确认资金准备
4. 导出条件单

### 周二：执行阶段
1. 9:30 开盘后观察市场
2. 10:30 执行第一批订单（Core+第一条腿）
3. 14:00 执行第二批订单（第二条腿）
4. 收盘后更新持仓记录

### 周三-周五：监控阶段
1. 每日查看持仓表现
2. 关注风险警告
3. 可转债网格自动执行

### 周末：复盘总结
1. 查看本周收益
2. 分析换腿信号
3. 调整下周计划

## 风险管理

### 风险等级说明

| 等级 | 图标 | 说明 | 建议行动 |
|-----|------|-----|---------|
| 低 | 🟢 | 正常范围 | 继续执行计划 |
| 中 | 🟡 | 需要关注 | 密切监控，准备调整 |
| 高 | 🔴 | 立即处理 | 执行风控措施 |
| 危急 | 🚨 | 系统性风险 | 暂停交易，全面评估 |

### 常见风险场景

**1. 市场系统性下跌**
- 触发：HS300跌破MA200
- 应对：减少卫星仓位，增加防御性资产

**2. 个股大幅回撤**
- 触发：单一持仓亏损>12%
- 应对：触及止损线，立即平仓

**3. 流动性枯竭**
- 触发：日均成交<3000万
- 应对：分批减仓，更换标的

**4. 数据异常**
- 触发：数据源故障或异常值
- 应对：暂停自动交易，人工确认

## 常见问题

### Q1: 为什么选择周二执行？
**A**: 周二通常是一周中市场最稳定的交易日，避开周一的跳空和周五的不确定性。

### Q2: IOPV是什么？为什么重要？
**A**: IOPV（基金份额参考净值）反映ETF的实时价值。通过IOPV限价可以避免买在溢价高点。

### Q3: 如何处理QDII的溢价？
**A**: QDII由于时差原因容易产生溢价。系统建议溢价>2%时暂缓买入。

### Q4: 建仓期6周是否可以调整？
**A**: 可以。激进型可缩短至3-4周，保守型可延长至8-12周。

### Q5: 如何处理强赎的可转债？
**A**: 系统会自动标记强赎风险，建议在强赎前主动转股或卖出。

### Q6: 系统崩溃了怎么办？
**A**: 
1. 查看 `docker-compose logs` 定位问题
2. 重启服务：`docker-compose restart`
3. 如果数据损坏，从备份恢复

### Q7: 可以接入实盘交易吗？
**A**: 当前版本仅生成条件单，不直接下单。需要券商API接入才能实现全自动。

### Q8: 历史回测效果如何？
**A**: 请参考 `docs/BACKTEST_REPORT.md` 查看详细回测报告。

## 进阶使用

### 自定义数据源
参考 `backend/data/datasource.py` 中的接口定义，实现自己的数据适配器。

### 策略优化
可以调整 `config.yaml` 中的参数，进行策略优化：
- 动量权重（r3m vs r6m）
- 止损和缓冲参数
- 持仓期限要求

### 监控告警
配置 `config/alert.yaml` 设置邮件/微信告警。

## 技术支持

- 📧 邮件：support@example.com
- 💬 微信群：扫码加入用户交流群
- 📖 文档：https://docs.example.com
- 🐛 Bug反馈：GitHub Issues

---

**免责声明**：本系统仅供投资决策参考，不构成投资建议。投资有风险，入市需谨慎。